{"openapi":"3.0.1","info":{"title":"OpenAPI definition","version":"v0"},"servers":[{"url":"http://localhost:8080","description":"Localhost"},{"url":"https://batteryswap.up.railway.app","description":"Railway"}],"tags":[{"name":"Invoice API","description":"API quản lý hóa đơn - Response đơn giản"},{"name":"System Price Management","description":"[ĐÃ NÂNG CẤP] APIs quản lý các loại giá linh hoạt"},{"name":"Staff: Dispute Ticket","description":"Quản lý Ticket Tranh chấp"},{"name":"Battery Rebalance API","description":"Quản lý điều phối pin giữa các trạm"},{"name":"Booking API","description":"API quản lý đặt chỗ thay pin"},{"name":"User Profile","description":"APIs quản lý thông tin cá nhân (đổi SĐT, mật khẩu)"},{"name":"Staff: Inspection","description":"Quản lý Kiểm tra Pin (Inspection)"},{"name":"Subscription Management","description":"APIs đăng ký và quản lý gói cước"},{"name":"Vehicle","description":"Vehicle management APIs"}],"paths":{"/api/users/profile/change-phone":{"put":{"tags":["User Profile"],"summary":"Đổi số điện thoại (cho người đã đăng nhập)","operationId":"changePhoneNumber","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangePhoneRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/system-price/update":{"put":{"tags":["System Price Management"],"summary":"Cập nhật một loại giá","description":"Cập nhật giá hoặc mô tả của một loại giá đã có","operationId":"updatePrice","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PriceRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/staff/tickets/{ticketId}":{"put":{"tags":["Staff: Dispute Ticket"],"summary":"Cập nhật Dispute Ticket","description":"Staff/Admin thay đổi trạng thái, mô tả, hoặc lý do cho Ticket.","operationId":"updateDisputeTicket","parameters":[{"name":"ticketId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketUpdateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TicketResponse"}}}}}}},"/api/staff/tickets/{ticketId}/resolve":{"put":{"tags":["Staff: Dispute Ticket"],"summary":"Giải quyết ticket","description":"Staff/Admin giải quyết ticket: chọn phương thức xử lý, mức phạt, và kênh thanh toán nếu có (VNPay, Wallet, hoặc Cash).","operationId":"resolveDisputeTicket","parameters":[{"name":"ticketId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketResolveRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TicketResponse"}}}}}}},"/api/staff/tickets/{ticketId}/confirm-cash":{"put":{"tags":["Staff: Dispute Ticket"],"operationId":"confirmCashPayment","parameters":[{"name":"ticketId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"staffId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/staff/inspections/{inspectionId}":{"put":{"tags":["Staff: Inspection"],"summary":"Cập nhật Inspection","description":"Staff cập nhật thông tin chi tiết của biên bản kiểm tra pin.","operationId":"updateInspection","parameters":[{"name":"inspectionId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InspectionUpdateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/InspectionResponse"}}}}}}},"/api/roles/{id}":{"put":{"tags":["role-controller"],"operationId":"updateRole","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/bookings/{bookingId}/vehicle":{"put":{"tags":["Booking API"],"summary":"Cập nhật xe trong booking","description":"Thay đổi xe trong booking đang chờ xử lý","operationId":"updateVehicleInBooking","parameters":[{"name":"bookingId","in":"path","description":"ID của booking","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"newVehicleId","in":"query","description":"ID xe mới","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"userId","in":"query","description":"ID của user","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/{bookingId}/status":{"put":{"tags":["Booking API"],"summary":"Cập nhật trạng thái booking","description":"Cập nhật trạng thái của một booking (dành cho admin/staff). Trạng thái: PENDINGPAYMENT, PENDINGSWAPPING, CANCELLED, COMPLETED, FAILED","operationId":"updateBookingStatus","parameters":[{"name":"bookingId","in":"path","description":"ID của booking","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"status","in":"query","description":"Trạng thái mới (PENDINGPAYMENT, PENDINGSWAPPING, CANCELLED, COMPLETED, FAILED)","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/{bookingId}/fail":{"put":{"tags":["Booking API"],"summary":"Chuyển trạng thái booking sang FAILED","description":"Cập nhật trạng thái của booking từ PENDINGPAYMENT sang FAILED trong trường hợp thanh toán thất bại","operationId":"markBookingAsFailed","parameters":[{"name":"bookingId","in":"path","description":"ID của booking","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/{bookingId}/complete-swapping":{"put":{"tags":["Booking API"],"summary":"Hoàn thành đổi pin","description":"Chuyển booking từ trạng thái PENDINGSWAPPING sang COMPLETED sau khi đổi pin thành công","operationId":"completeBatterySwapping","parameters":[{"name":"bookingId","in":"path","description":"ID của booking","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/{bookingId}/cancel-with-refund":{"put":{"tags":["Booking API"],"summary":"Hủy booking kèm hoàn tiền","description":"Nếu booking đã thanh toán, hệ thống sẽ tự động hoàn tiền VNPay. Nếu chưa thanh toán, chỉ hủy booking.","operationId":"cancelBookingWithRefund","parameters":[{"name":"bookingId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/staff/cancel-with-refund/{bookingId}":{"put":{"tags":["Booking API"],"summary":"Staff hủy booking kèm hoàn tiền","description":"Cho phép staff hủy booking của user và hoàn tiền về ví mà không cần kiểm tra điều kiện thời gian. Staff cần cung cấp lý do hủy.","operationId":"staffCancelBookingWithRefund","parameters":[{"name":"bookingId","in":"path","description":"ID của booking cần hủy","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StaffCancelBookingRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/cancel":{"put":{"tags":["Booking API"],"summary":"Hủy booking","description":"Hủy một booking đã tạo","operationId":"cancelBooking","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelBookingRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/auth/role/{userId}":{"put":{"tags":["auth-controller"],"operationId":"updateUserRole","parameters":[{"name":"userId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/admin/system-prices/{priceType}":{"get":{"tags":["admin-system-price-controller"],"operationId":"getSystemPriceByType","parameters":[{"name":"priceType","in":"path","required":true,"schema":{"type":"string","enum":["BATTERY_SWAP","SERVICE_FEE","MAINTENANCE","MONTHLY_SUBSCRIPTION_BASIC","MONTHLY_SUBSCRIPTION_PREMIUM","MONTHLY_SUBSCRIPTION_BUSINESS","DAMAGE_FEE","PENALTY_MINOR","PENALTY_MEDIUM","PENALTY_SEVERE"]}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SystemPrice"}}}}}},"put":{"tags":["admin-system-price-controller"],"operationId":"updateSystemPrice","parameters":[{"name":"priceType","in":"path","required":true,"schema":{"type":"string","enum":["BATTERY_SWAP","SERVICE_FEE","MAINTENANCE","MONTHLY_SUBSCRIPTION_BASIC","MONTHLY_SUBSCRIPTION_PREMIUM","MONTHLY_SUBSCRIPTION_BUSINESS","DAMAGE_FEE","PENALTY_MINOR","PENALTY_MEDIUM","PENALTY_SEVERE"]}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SystemPriceUpdateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SystemPrice"}}}}}}},"/api/admin/staff/{staffId}":{"put":{"tags":["admin-staff-controller"],"summary":"assign staff, có thể null station id nếu chỉ đổi isactive","operationId":"updateStaffAssign","parameters":[{"name":"staffId","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateStaffAssignRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/StaffListItemDTO"}}}}}}},"/api/v1/vehicles/{vehicleId}/deactivate":{"post":{"tags":["Vehicle"],"summary":"Hủy kích hoạt phương tiện","operationId":"deactivateVehicle","parameters":[{"name":"vehicleId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/v1/vehicles/register":{"post":{"tags":["Vehicle"],"summary":"Đăng ký phương tiện mới và gán cho người dùng hiện tại","operationId":"registerNewVehicle","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VehicleRegistrationRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/v1/vehicles/assign":{"post":{"tags":["Vehicle"],"summary":"Gán phương tiện cho người dùng hiện tại","operationId":"assignVehicle","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AssignVehicleRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/users/profile/change-password":{"post":{"tags":["User Profile"],"summary":"Đổi mật khẩu (cho người đã đăng nhập)","operationId":"changePassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangePasswordRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/system-price/create":{"post":{"tags":["System Price Management"],"summary":"Tạo một loại giá mới","description":"Tạo một loại giá mới (ví dụ: MONTHLY_SUBSCRIPTION)","operationId":"createPrice","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PriceRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/system-price/calculate":{"get":{"tags":["System Price Management"],"summary":"Tính tổng tiền (cho ĐỔI PIN)","description":"Tính tổng tiền dựa trên số lượng lượt đổi pin (dùng giá BATTERY_SWAP)","operationId":"calculateTotalAmount","parameters":[{"name":"quantity","in":"query","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}},"post":{"tags":["System Price Management"],"summary":"Tính tổng tiền (POST, cho ĐỔI PIN)","description":"Tính tổng tiền dựa trên số lượng lượt đổi pin (dùng giá BATTERY_SWAP)","operationId":"calculateTotalAmountPost","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CalculateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/swaps/commit":{"post":{"tags":["SWAP"],"operationId":"commitSwap","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SwapRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/swaps/checkBatteryModel":{"post":{"tags":["SWAP"],"operationId":"checkBatteryModel","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatteryModelCheckRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/swaps/cancel":{"post":{"tags":["SWAP"],"operationId":"cancelSwap","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SwapCancelRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/staff/tickets":{"post":{"tags":["Staff: Dispute Ticket"],"summary":"Tạo Dispute Ticket","description":"Staff tạo Ticket tranh chấp liên kết với Booking và Trạm.","operationId":"createDisputeTicket","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TicketRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/staff/inspections":{"post":{"tags":["Staff: Inspection"],"summary":"Staff tạo Inspection","description":"Ghi nhận biên bản kiểm tra pin do người dùng bỏ vào.","operationId":"createInspection","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InspectionRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/roles":{"get":{"tags":["role-controller"],"operationId":"getAllRoles","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RoleDTO"}}}}}}},"post":{"tags":["role-controller"],"operationId":"createRole","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoleDTO"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/rebalances":{"get":{"tags":["Battery Rebalance API"],"summary":"Admin Lấy danh sách lệnh điều phối pin","operationId":"getAllOrders","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}},"post":{"tags":["Battery Rebalance API"],"summary":"Tạo lệnh điều phối mới (staff và admin gửi yêu cầu thủ công)","operationId":"createOrder","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RebalanceRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/rebalances/apply-ai":{"post":{"tags":["Battery Rebalance API"],"summary":"Admin - Áp dụng gợi ý AI → tạo lệnh điều phối thực tế","operationId":"applyAiSuggestion","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RebalanceSuggestion"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/plans/use-swap":{"post":{"tags":["Subscription Management"],"summary":"Thanh toán Booking bằng Gói tháng (dùng 1 lượt)","description":"User gọi API này để 'thanh toán' cho Invoice 0 ĐỒNG, sử dụng 1 lượt trong gói cước.","operationId":"useSwapForBooking","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UseSwapRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/plans/subscribe":{"post":{"tags":["Subscription Management"],"summary":"Đăng ký gói cước","description":"Tạo hóa đơn đăng ký gói cước mới cho user.","operationId":"subscribeToPlan","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/plans/cancel":{"post":{"tags":["Subscription Management"],"summary":"Hủy gói cước","description":"Tắt tự động gia hạn. Gói cước vẫn dùng được đến hết hạn.","operationId":"cancelSubscription","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/plans/cancel-immediately":{"post":{"tags":["Subscription Management"],"summary":"Hủy gói cước ngay lập tức có hoàn tiền","description":"Hủy gói ngay, chuyển status thành CANCELLED và hoàn tiền theo lượt còn lại.","operationId":"cancelSubscriptionImmediately","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/payments/vnpay/wallet/topup":{"post":{"tags":["payment-controller"],"summary":"Nạp tiền vào ví (VNPay)","operationId":"topupWallet","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WalletTopupRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/payments/vnpay/refund-booking/{bookingId}":{"post":{"tags":["payment-controller"],"operationId":"refundBooking","parameters":[{"name":"bookingId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/payments/vnpay/create":{"post":{"tags":["payment-controller"],"operationId":"createPayment","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VnPayCreatePaymentRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/VnPayCreatePaymentResponse"}}}}}}},"/api/payments/vnpay/create-subscription":{"post":{"tags":["payment-controller"],"operationId":"createSubscriptionPayment","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VnPayCreatePaymentRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/VnPayCreatePaymentResponse"}}}}}}},"/api/invoices/{id}/cancel":{"post":{"tags":["Invoice API"],"summary":"Hủy Invoice (cho User)","description":"Cho phép người dùng hủy một invoice đang ở trạng thái PENDING. Tất cả booking và payment liên quan sẽ bị hủy theo.","operationId":"cancelInvoice","parameters":[{"name":"id","in":"path","description":"ID của invoice cần hủy","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/invoices/create":{"post":{"tags":["Invoice API"],"summary":"Tạo invoice từ danh sách pin","description":"Tạo invoice ngay khi user chọn pin, trả về invoiceId và tổng tiền","operationId":"createInvoiceFromBatteries","parameters":[{"name":"userId","in":"query","description":"ID của user","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/invoices/create-from-multiple-bookings":{"post":{"tags":["Invoice API"],"summary":"Tạo invoice từ nhiều booking","description":"Tạo 1 invoice chung từ nhiều booking","operationId":"createInvoiceFromMultipleBookings","requestBody":{"content":{"application/json":{"schema":{"type":"array","description":"Danh sách ID của các booking","items":{"type":"integer","format":"int64"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/invoices/create-from-booking":{"post":{"tags":["Invoice API"],"summary":"Tạo invoice từ 1 booking","description":"Tạo invoice mới từ một booking đã thanh toán","operationId":"createInvoiceFromBooking","parameters":[{"name":"bookingId","in":"query","description":"ID của booking","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings":{"get":{"tags":["Booking API"],"summary":"Lấy tất cả booking","description":"Lấy danh sách tất cả booking (dành cho admin)","operationId":"getAllBookings","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}},"post":{"tags":["Booking API"],"summary":"Tạo booking mới","description":"Tạo một booking mới cho việc thay pin","operationId":"createBooking","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BookingRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/{bookingId}/process-payment":{"post":{"tags":["Booking API"],"summary":"Xử lý thanh toán booking","description":"Chuyển trạng thái booking từ PENDINGPAYMENT sang PENDINGSWAPPING","operationId":"processPayment","parameters":[{"name":"bookingId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/vehicles/{vehicleId}/quick-book":{"post":{"tags":["Booking API"],"summary":"Tạo booking nhanh cho xe cụ thể","description":"Tạo booking nhanh cho một xe với thông tin cơ bản","operationId":"createQuickBookingForVehicle","parameters":[{"name":"vehicleId","in":"path","description":"ID của xe","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"userId","in":"query","description":"ID của user","required":true,"schema":{"type":"string"}},{"name":"stationId","in":"query","description":"ID của station","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"date","in":"query","description":"Ngày booking (yyyy-MM-dd)","required":true,"schema":{"type":"string"}},{"name":"time","in":"query","description":"Giờ booking (HH:mm)","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/validate-multiple-vehicles":{"post":{"tags":["Booking API"],"summary":"Kiểm tra nhiều xe có thể booking","description":"Kiểm tra danh sách xe có thể đặt lịch hay không","operationId":"validateMultipleVehicles","parameters":[{"name":"userId","in":"query","description":"ID của user","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"integer","format":"int32"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/quick-book":{"post":{"tags":["Booking API"],"summary":"Tạo booking nhanh","description":"Tạo booking nhanh với vehicleId, stationId và thông tin cơ bản, tự động lấy userId từ xe","operationId":"quickBooking","requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/createinvoice":{"post":{"tags":["Booking API"],"summary":"Tạo invoice và bookings từ danh sách xe","description":"Tạo invoice và bookings cho từng xe được chọn, tự động lấy userId từ xe","operationId":"createInvoiceFromVehicles","requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"object","additionalProperties":{"type":"object"}}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/create-after-payment":{"post":{"tags":["Booking API"],"summary":"Tạo booking sau khi thanh toán","description":"Tạo booking sau khi thanh toán đã hoàn thành - Flow mới","operationId":"createBookingAfterPayment","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentCompletedRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/batch":{"post":{"tags":["Booking API"],"summary":"Tạo nhiều booking linh hoạt (tối đa 3 xe)","description":"Mỗi xe có thể đặt khác trạm, khác giờ","operationId":"createBatchBooking","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FlexibleBatchBookingRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/batch-schedule":{"post":{"tags":["Booking API"],"summary":"Cập nhật lịch trình cho nhiều booking","description":"Cập nhật ngày giờ cho nhiều booking cùng lúc","operationId":"updateMultipleBookingSchedules","requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"object","additionalProperties":{"type":"object"}}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/batteries/insert":{"post":{"tags":["battery-controller"],"summary":"Thêm pin vào slot","operationId":"insertBattery","parameters":[{"name":"slotId","in":"query","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"batteryId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/batteries/eject/{batteryId}":{"post":{"tags":["battery-controller"],"summary":"lấy pin ra khỏi slot","operationId":"ejectBattery","parameters":[{"name":"batteryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/auth/reset-password":{"post":{"tags":["auth-controller"],"operationId":"resetPassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/resend-verification":{"post":{"tags":["auth-controller"],"operationId":"resendVerification","parameters":[{"name":"token","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/register":{"post":{"tags":["auth-controller"],"operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/login":{"post":{"tags":["auth-controller"],"operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/google":{"post":{"tags":["auth-controller"],"summary":"Đăng nhập / Đăng ký qua Google","operationId":"loginWithGoogle","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GoogleLoginRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/forgot-password":{"post":{"tags":["auth-controller"],"operationId":"forgotPassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/admin/vehicles/import":{"post":{"tags":["admin-vehicle-controller"],"operationId":"importVehicles","requestBody":{"content":{"multipart/form-data":{"schema":{"required":["file"],"type":"object","properties":{"file":{"type":"string","format":"binary"}}}}}},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/admin/staff":{"get":{"tags":["admin-staff-controller"],"summary":"Lấy danh sách staff được group theo trạm","operationId":"getAllStaffGrouped","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/StationStaffGroupDTO"}}}}}}},"post":{"tags":["admin-staff-controller"],"summary":"Tạo tài khoản cho staff","operationId":"createStaff","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateStaffRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/rebalances/{id}/status":{"patch":{"tags":["Battery Rebalance API"],"summary":"Cập nhật trạng thái lệnh điều phối","operationId":"updateStatus","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"status","in":"query","required":true,"schema":{"type":"string","enum":["PENDING","SCHEDULED","IN_TRANSIT","COMPLETED","CANCELLED"]}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/bookings/{bookingId}/schedule":{"patch":{"tags":["Booking API"],"summary":"Cập nhật lịch trình cho booking","description":"Cập nhật ngày giờ cho booking đã tạo","operationId":"updateBookingSchedule","parameters":[{"name":"bookingId","in":"path","description":"ID của booking","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"date","in":"query","description":"Ngày sử dụng (yyyy-MM-dd)","required":true,"schema":{"type":"string"}},{"name":"time","in":"query","description":"Giờ sử dụng (HH:mm)","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/batteries/status":{"patch":{"tags":["battery-controller"],"summary":"Cập nhật trạng thái pin","operationId":"updateBatteryStatus","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatteryStatusUpdateRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/test-socket":{"get":{"tags":["battery-socket-controller"],"operationId":"sendTestMessage","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/v1/vehicles/{vin}":{"get":{"tags":["Vehicle"],"summary":"Lấy thông tin phương tiện theo VIN","operationId":"getVehicleByVIN","parameters":[{"name":"vin","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/VehicleInfoResponse"}}}}}}},"/api/v1/vehicles/unassigned":{"get":{"tags":["Vehicle"],"operationId":"getUnassignedVehicles","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/VehicleSimpleResponse"}}}}}}}},"/api/v1/vehicles/my-vehicles":{"get":{"tags":["Vehicle"],"operationId":"getMyVehicles","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/VehicleMyResponse"}}}}}}}},"/api/system-price/{priceType}":{"get":{"tags":["System Price Management"],"summary":"Lấy một loại giá cụ thể","description":"Lấy giá theo mã, ví dụ: BATTERY_SWAP hoặc MONTHLY_SUBSCRIPTION","operationId":"getPriceByType","parameters":[{"name":"priceType","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/system-price/all":{"get":{"tags":["System Price Management"],"summary":"Lấy TẤT CẢ loại giá","description":"Lấy danh sách tất cả các loại giá trong hệ thống (BATTERY_SWAP, MONTHLY_SUBSCRIPTION...)","operationId":"getAllPrices","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/swaps":{"get":{"tags":["SWAP"],"summary":"Lấy danh sách các lần swap theo trạm","operationId":"getSwapsByStation","parameters":[{"name":"stationId","in":"query","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/stations":{"get":{"tags":["station-controller"],"operationId":"getAllStations","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/StationResponseDTO"}}}}}}}},"/api/stations/{stationId}/batteries/grouped":{"get":{"tags":["station-controller"],"operationId":"getGroupedBatteriesByDock","parameters":[{"name":"stationId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DockBatteryGroupDTO"}}}}}}}},"/api/stations/{id}":{"get":{"tags":["station-controller"],"operationId":"getStationDetail","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/StationResponseDTO"}}}}}}},"/api/stations/nearby":{"get":{"tags":["station-controller"],"operationId":"getNearbyStations","parameters":[{"name":"lat","in":"query","required":true,"schema":{"type":"number","format":"double"}},{"name":"lng","in":"query","required":true,"schema":{"type":"number","format":"double"}},{"name":"radiusKm","in":"query","required":false,"schema":{"type":"number","format":"double","default":50.0}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/StationResponseDTO"}}}}}}}},"/api/staff/tickets/staff/{staffUserId}":{"get":{"tags":["Staff: Dispute Ticket"],"summary":"Staff lấy Ticket đã tạo","description":"Lấy danh sách các ticket tranh chấp đã được TẠO bởi Staff này.","operationId":"getDisputesByStaff","parameters":[{"name":"staffUserId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TicketResponse"}}}}}}}},"/api/staff/tickets/open":{"get":{"tags":["Staff: Dispute Ticket"],"summary":"Staff lấy các Dispute CHƯA XỬ LÝ","operationId":"getOpenDisputes","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TicketResponse"}}}}}}}},"/api/staff/tickets/by-station":{"get":{"tags":["Staff: Dispute Ticket"],"summary":"Staff lấy Dispute (Tranh chấp) theo Trạm","operationId":"getDisputesByStation","parameters":[{"name":"stationId","in":"query","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/staff/inspections/staff/{staffUserId}":{"get":{"tags":["Staff: Inspection"],"summary":"Lấy danh sách Inspection được thực hiện bởi Staff","description":"Lấy danh sách các Inspection do Staff có ID này thực hiện.","operationId":"getInspectionsByStaff","parameters":[{"name":"staffUserId","in":"path","description":"ID của Staff, ví dụ: ST006","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/InspectionResponse"}}}}}}}},"/api/staff/inspections/all":{"get":{"tags":["Staff: Inspection"],"summary":"Staff lấy TẤT CẢ Inspection","description":"Lấy danh sách tất cả các biên bản kiểm tra pin đã tạo.","operationId":"getAllInspections","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/InspectionResponse"}}}}}}}},"/api/reports/{id}/export":{"get":{"tags":["report-controller"],"summary":"Xuất báo cáo (single) ra file Excel","operationId":"exportReport","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"File Excel được tạo thành công","content":{"application/octet-stream":{"schema":{"type":"string","format":"binary"}}}},"500":{"description":"Lỗi khi tạo báo cáo","content":{"application/octet-stream":{"schema":{"type":"string","format":"byte"}}}}}}},"/api/reports/swap/hourly":{"get":{"tags":["report-controller"],"summary":"Báo cáo số lần đổi pin hàng giờ trong khoảng thời gian","operationId":"getSwapHourly","parameters":[{"name":"startDate","in":"query","required":true,"schema":{"type":"string","format":"date"}},{"name":"endDate","in":"query","required":true,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/reports/swap/daily":{"get":{"tags":["report-controller"],"summary":"Báo cáo số lần đổi pin hàng ngày trong khoảng thời gian","operationId":"getSwapDaily","parameters":[{"name":"startDate","in":"query","required":true,"schema":{"type":"string","format":"date"}},{"name":"endDate","in":"query","required":true,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/reports/summary":{"get":{"tags":["report-controller"],"summary":"Báo cáo tổng hợp hiệu suất hoạt động của hệ thống","operationId":"getSummary","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/reports/stations":{"get":{"tags":["report-controller"],"summary":"Báo cáo tổng hợp hàng ngày của tất cả các trạm trong khoảng ngày gần nhất","operationId":"getAllStationReports","parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":7}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/reports/station/{stationId}/range":{"get":{"tags":["report-controller"],"summary":"Báo cáo hiệu suất trạm trong khoảng 7 ngày gần nhất","operationId":"getStationReportInRange","parameters":[{"name":"stationId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"days","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":7}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/reports/station/performance":{"get":{"tags":["report-controller"],"summary":"Báo cáo hiệu suất trạm trong ngày hôm nay","operationId":"getStationPerformance","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/reports/revenue/hourly":{"get":{"tags":["report-controller"],"summary":"Báo cáo doanh thu hàng giờ trong khoảng thời gian","operationId":"getRevenueHourly","parameters":[{"name":"startDate","in":"query","required":true,"schema":{"type":"string","format":"date"}},{"name":"endDate","in":"query","required":true,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/reports/revenue/daily":{"get":{"tags":["report-controller"],"summary":"Báo cáo doanh thu hàng ngày trong khoảng thời gian","operationId":"getRevenueDaily","parameters":[{"name":"startDate","in":"query","required":true,"schema":{"type":"string","format":"date"}},{"name":"endDate","in":"query","required":true,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/reports/export/all":{"get":{"tags":["report-controller"],"summary":"Xuất tất cả báo cáo thành file Excel với nhiều sheet","operationId":"exportAllReports","parameters":[{"name":"startDate","in":"query","required":true,"schema":{"type":"string","format":"date"}},{"name":"endDate","in":"query","required":true,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"File Excel được tạo thành công","content":{"application/octet-stream":{"schema":{"type":"string","format":"binary"}}}},"500":{"description":"Lỗi khi tạo báo cáo","content":{"application/octet-stream":{"schema":{"type":"string","format":"byte"}}}}}}},"/api/rebalances/suggestions":{"get":{"tags":["Battery Rebalance API"],"summary":"Admin - Gợi ý điều phối từ AI (Linear Programming)","operationId":"getAiSuggestions","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/plans/my-subscription":{"get":{"tags":["Subscription Management"],"summary":"Lấy gói cước đang ACTIVE","description":"Lấy thông tin gói cước đang hoạt động (nếu có) của user.","operationId":"getMyActiveSubscription","parameters":[{"name":"userId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/plans/my-history":{"get":{"tags":["Subscription Management"],"summary":"Lấy lịch sử gói cước","description":"Lấy tất cả các gói cước đã mua (active, expired, cancelled).","operationId":"getMySubscriptionHistory","parameters":[{"name":"userId","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/plans/all":{"get":{"tags":["Subscription Management"],"summary":"Lấy tất cả các Gói Subscription có sẵn","description":"Hiển thị danh sách tất cả các gói (Basic, Premium, Unlimited) mà user có thể đăng ký.","operationId":"getAllPlans","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/payments/vnpay/status/{txnRef}":{"get":{"tags":["payment-controller"],"operationId":"getPaymentStatus","parameters":[{"name":"txnRef","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PaymentResponse"}}}}}}},"/api/payments/vnpay/return":{"get":{"tags":["payment-controller"],"operationId":"handleVnPayReturn","parameters":[{"name":"queryParams","in":"query","required":true,"schema":{"type":"object","additionalProperties":{"type":"string"}}}],"responses":{"200":{"description":"OK"}}}},"/api/payments/vnpay/ipn":{"get":{"tags":["payment-controller"],"operationId":"handleVnPayIpn","parameters":[{"name":"queryParams","in":"query","required":true,"schema":{"type":"object","additionalProperties":{"type":"string"}}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"}}}}}}}},"/api/invoices":{"get":{"tags":["Invoice API"],"summary":"Lấy danh sách tất cả invoice","description":"Trả về danh sách invoice đơn giản","operationId":"getAllInvoicesSimple","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/invoices/{invoiceId}":{"get":{"tags":["Invoice API"],"summary":"Lấy thông tin invoice đơn giản","description":"Trả về thông tin invoice cơ bản, không có nested objects","operationId":"getInvoiceSimple","parameters":[{"name":"invoiceId","in":"path","description":"ID của invoice","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}},"delete":{"tags":["Invoice API"],"summary":"Xóa invoice","description":"Xóa một invoice theo ID","operationId":"deleteInvoice","parameters":[{"name":"invoiceId","in":"path","description":"ID của invoice","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/invoices/user/{userId}":{"get":{"tags":["Invoice API"],"summary":"Lấy invoice của user","description":"Trả về danh sách invoice của một user cụ thể","operationId":"getUserInvoices","parameters":[{"name":"userId","in":"path","description":"ID của user","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/invoices/status/{status}":{"get":{"tags":["Invoice API"],"summary":"Lọc hóa đơn theo trạng thái","description":"Lấy danh sách hóa đơn theo trạng thái (PENDING, PAID, PAYMENTFAILED)","operationId":"getInvoicesByStatus","parameters":[{"name":"status","in":"path","description":"Trạng thái cần lọc (PENDING, PAID, PAYMENTFAILED)","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/dashboard":{"get":{"tags":["dashboard-controller"],"operationId":"getDashboardData","parameters":[{"name":"userId","in":"query","required":false,"schema":{"type":"string"}},{"name":"role","in":"query","required":false,"schema":{"type":"string"}},{"name":"stationId","in":"query","required":false,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/DashboardResponse"}}}}}}},"/api/dashboard/staff":{"get":{"tags":["dashboard-controller"],"operationId":"getStaffDashboard","parameters":[{"name":"stationId","in":"query","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"date","in":"query","required":false,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/DashboardResponse"}}}}}}},"/api/dashboard/admin":{"get":{"tags":["dashboard-controller"],"operationId":"getAdminDashboard","parameters":[{"name":"date","in":"query","required":false,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/DashboardResponse"}}}}}}},"/api/bookings/{bookingId}":{"get":{"tags":["Booking API"],"summary":"Lấy thông tin booking theo ID","description":"Trả chi tiết thông tin booking: khách hàng, xe, trạm, thanh toán... Dùng cho cả FE và QR","operationId":"getBookingById","parameters":[{"name":"bookingId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/{bookingId}/generateQr":{"get":{"tags":["Booking API"],"summary":"Tạo QR token cho booking","description":"FE gọi để lấy token text dùng sinh QR hình ảnh, cho phép tạo QR ngay cả khi chưa thanh toán","operationId":"generateQr","parameters":[{"name":"bookingId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/verifyQr":{"get":{"tags":["Booking API"],"summary":"Xác thực QR booking","description":"FE staff quét QR và gửi token lên để lấy thông tin booking","operationId":"verifyQr","parameters":[{"name":"token","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/vehicles/{vehicleId}":{"get":{"tags":["Booking API"],"summary":"Lấy thông tin chi tiết xe","description":"Lấy thông tin chi tiết của một xe theo vehicleId","operationId":"getVehicleDetail","parameters":[{"name":"vehicleId","in":"path","description":"ID của xe","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/vehicles/{vehicleId}/bookings":{"get":{"tags":["Booking API"],"summary":"Lấy lịch sử booking của xe","description":"Lấy tất cả booking của một xe cụ thể theo vehicleId","operationId":"getVehicleBookings","parameters":[{"name":"vehicleId","in":"path","description":"ID của xe","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"userId","in":"query","description":"ID của user","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/vehicles/validate/{vehicleId}":{"get":{"tags":["Booking API"],"summary":"Kiểm tra xe có thể booking","description":"Kiểm tra xe có tồn tại và có thể đặt lịch không","operationId":"validateVehicleForBooking","parameters":[{"name":"vehicleId","in":"path","description":"ID của xe","required":true,"schema":{"type":"integer","format":"int32"}},{"name":"userId","in":"query","description":"ID của user","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/vehicles/user/{userId}":{"get":{"tags":["Booking API"],"summary":"Lấy danh sách xe của user","description":"Lấy tất cả xe thuộc về một user cụ thể","operationId":"getUserVehicles","parameters":[{"name":"userId","in":"path","description":"ID của user","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/vehicles/search":{"get":{"tags":["Booking API"],"summary":"Tìm kiếm xe để booking","description":"Tìm kiếm xe có thể đặt lịch dựa trên các tiêu chí","operationId":"searchVehiclesForBooking","parameters":[{"name":"userId","in":"query","description":"ID của user","required":true,"schema":{"type":"string"}},{"name":"vehicleType","in":"query","description":"Loại xe","required":false,"schema":{"type":"string"}},{"name":"batteryType","in":"query","description":"Loại pin","required":false,"schema":{"type":"string"}},{"name":"licensePlate","in":"query","description":"Biển số xe","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/user/{userId}":{"get":{"tags":["Booking API"],"summary":"Lấy danh sách booking của user","description":"Lấy tất cả booking của một user cụ thể","operationId":"getUserBookings","parameters":[{"name":"userId","in":"path","description":"ID của user","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/status/{status}":{"get":{"tags":["Booking API"],"summary":"Lấy booking theo trạng thái","description":"Lấy danh sách booking theo trạng thái cụ thể (PENDINGPAYMENT, PENDINGSWAPPING, CANCELLED, COMPLETED)","operationId":"getBookingsByStatus","parameters":[{"name":"status","in":"path","description":"Trạng thái booking (PENDINGPAYMENT, PENDINGSWAPPING, CANCELLED, COMPLETED)","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/statistics/user/{userId}":{"get":{"tags":["Booking API"],"summary":"Thống kê booking của user","description":"Lấy thống kê chi tiết về booking của user","operationId":"getUserBookingStatistics","parameters":[{"name":"userId","in":"path","description":"ID của user","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/bookings/station/{stationId}":{"get":{"tags":["Booking API"],"summary":"Lấy booking của station","description":"Lấy tất cả booking của một station cụ thể","operationId":"getStationBookings","parameters":[{"name":"stationId","in":"path","description":"ID của station","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/bookings/battery-types":{"get":{"tags":["Booking API"],"summary":"Lấy danh sách loại pin và giá","description":"[ĐÃ CẬP NHẬT] Lấy tất cả loại pin và giá đổi pin tiêu chuẩn","operationId":"getBatteryTypes","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/batteries/{batteryId}":{"get":{"tags":["battery-controller"],"operationId":"getBatteryById","parameters":[{"name":"batteryId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/batteries/waiting":{"get":{"tags":["battery-controller"],"summary":"Lấy danh sách pin đang ở trạng thái chờ tại trạm (WAITING trong slot)","operationId":"getWaitingBatteries","parameters":[{"name":"stationId","in":"query","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/batteries/vehicle/{vehicleId}":{"get":{"tags":["battery-controller"],"operationId":"getBatteryOfVehicle","parameters":[{"name":"vehicleId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/batteries/loose":{"get":{"tags":["battery-controller"],"summary":"Lấy danh sách pin rời tại trạm (không nằm trong DockSlot)","operationId":"getLooseBatteries","parameters":[{"name":"stationId","in":"query","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/batteries/loose/all":{"get":{"tags":["battery-controller"],"summary":"Liệt kê toàn bộ pin rời theo từng trạm (không nằm trong DockSlot)","operationId":"getAllLooseBatteriesGroupedByStation","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/batteries/analytics":{"get":{"tags":["battery-controller"],"summary":"[TEST]Thống kê pin trong hệ thống","operationId":"getBatteryAnalytics","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/verify-email":{"get":{"tags":["auth-controller"],"operationId":"verifyEmail","parameters":[{"name":"token","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/auth/send":{"get":{"tags":["auth-controller"],"operationId":"testEmail","parameters":[{"name":"to","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}}}},"/api/auth/me":{"get":{"tags":["auth-controller"],"operationId":"getCurrentUser","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/admin/vehicles":{"get":{"tags":["admin-vehicle-controller"],"operationId":"getAllVehicles","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object","additionalProperties":{"type":"object"}}}}}}}},"/api/admin/system-prices":{"get":{"tags":["admin-system-price-controller"],"operationId":"getAllSystemPrices","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SystemPrice"}}}}}}}},"/api/admin/staff/station/{stationId}":{"get":{"tags":["admin-staff-controller"],"summary":"lấy danh sách staff theo trạm","operationId":"getStaffByStation","parameters":[{"name":"stationId","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/StaffListItemDTO"}}}}}}}},"/api/admin/staff/list":{"get":{"tags":["admin-staff-controller"],"summary":"Lấy danh sách staff bth","operationId":"getAllStaffFlat","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/StaffListItemDTO"}}}}}}}},"/api/users/profile/me":{"delete":{"tags":["User Profile"],"summary":"User tự xoá tài khoản của mình","operationId":"deleteMyAccount","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}},"/api/bookings/delete":{"delete":{"tags":["Booking API"],"summary":"Xóa một hoặc nhiều booking","description":"Xóa booking theo danh sách ID, bất kể trạng thái. Gửi [101] để xóa 1 booking.","operationId":"deleteBatchBookings","requestBody":{"content":{"application/json":{"schema":{"type":"array","description":"Danh sách ID của các booking cần xóa. Ví dụ: [1, 2]","items":{"type":"integer","format":"int64"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/admin/staff/{staffId}/unassign":{"delete":{"tags":["admin-staff-controller"],"summary":"hủy assgin staff","operationId":"unassignStaff","parameters":[{"name":"staffId","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}}}}},"components":{"schemas":{"ChangePhoneRequest":{"required":["newPhoneNumber"],"type":"object","properties":{"newPhoneNumber":{"pattern":"^(0[3|5|7|8|9])+([0-9]{8})$","type":"string"}}},"PriceRequest":{"type":"object","properties":{"priceType":{"type":"string","enum":["BATTERY_SWAP","SERVICE_FEE","MAINTENANCE","MONTHLY_SUBSCRIPTION_BASIC","MONTHLY_SUBSCRIPTION_PREMIUM","MONTHLY_SUBSCRIPTION_BUSINESS","DAMAGE_FEE","PENALTY_MINOR","PENALTY_MEDIUM","PENALTY_SEVERE"]},"price":{"type":"number","format":"double"},"description":{"type":"string"}}},"TicketUpdateRequest":{"type":"object","properties":{"newDescription":{"type":"string"},"newStatus":{"type":"string"},"newReason":{"type":"string"}}},"TicketResponse":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"bookingId":{"type":"integer","format":"int64"},"title":{"type":"string"},"description":{"type":"string"},"status":{"type":"string"},"resolvedAt":{"type":"string","format":"date-time"},"resolutionMethod":{"type":"string"},"resolutionDescription":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"createdByStaffName":{"type":"string"},"reason":{"type":"string"},"invoiceId":{"type":"integer","format":"int64"},"refundAmount":{"type":"number","format":"double"},"refundedBookingId":{"type":"integer","format":"int64"},"penaltyLevel":{"type":"string"},"paymentChannel":{"type":"string"},"refundType":{"type":"string"},"refundSwapCount":{"type":"integer","format":"int32"}}},"TicketResolveRequest":{"type":"object","properties":{"resolutionMethod":{"type":"string","enum":["PENALTY","REFUND","NO_ACTION","OTHER"]},"resolutionDescription":{"type":"string"},"penaltyLevel":{"type":"string","enum":["NONE","MINOR","MEDIUM","SEVERE"]},"paymentChannel":{"type":"string","enum":["WALLET","VNPAY","CASH","NONE"]}}},"InspectionUpdateRequest":{"type":"object","properties":{"stateOfHealth":{"type":"number","format":"double"},"physicalNotes":{"type":"string"},"damaged":{"type":"boolean"},"newStatus":{"type":"string"}}},"InspectionResponse":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"inspectionTime":{"type":"string","format":"date-time"},"stateOfHealth":{"type":"number","format":"double"},"physicalNotes":{"type":"string"},"damaged":{"type":"boolean"},"batteryId":{"type":"string"},"status":{"type":"string"}}},"RoleDTO":{"type":"object","properties":{"roleId":{"type":"integer","format":"int32"},"roleName":{"type":"string"}}},"ApiResponse":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"},"data":{"type":"object"}}},"StaffCancelBookingRequest":{"required":["cancelReason","staffUserId"],"type":"object","properties":{"staffUserId":{"type":"string"},"cancelReason":{"type":"string"},"notes":{"type":"string"}},"description":"Thông tin hủy booking"},"CancelBookingRequest":{"type":"object","properties":{"bookingId":{"type":"integer","format":"int64"},"userId":{"type":"string"},"cancelReason":{"type":"string"}}},"SystemPriceUpdateRequest":{"required":["price"],"type":"object","properties":{"price":{"type":"number","format":"double"},"description":{"type":"string"}}},"SystemPrice":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"priceType":{"type":"string","enum":["BATTERY_SWAP","SERVICE_FEE","MAINTENANCE","MONTHLY_SUBSCRIPTION_BASIC","MONTHLY_SUBSCRIPTION_PREMIUM","MONTHLY_SUBSCRIPTION_BUSINESS","DAMAGE_FEE","PENALTY_MINOR","PENALTY_MEDIUM","PENALTY_SEVERE"]},"price":{"type":"number","format":"double"},"description":{"type":"string"},"createdDate":{"type":"string","format":"date-time"},"updatedDate":{"type":"string","format":"date-time"}}},"UpdateStaffAssignRequest":{"type":"object","properties":{"stationId":{"type":"integer","format":"int32"}}},"StaffListItemDTO":{"type":"object","properties":{"staffId":{"type":"string"},"fullName":{"type":"string"},"email":{"type":"string"},"stationId":{"type":"integer","format":"int32"},"stationName":{"type":"string"},"active":{"type":"boolean"}}},"VehicleRegistrationRequest":{"required":["vin"],"type":"object","properties":{"vin":{"pattern":"^[A-HJ-NPR-Z0-9]{17}$","type":"string"},"vehicleType":{"type":"string","enum":["THEON","FELIZ","KLARA_S","KLARA_A2","TEMPEST","VENTO","VF_5","VF_6","VF_7","VF_8","VF_9"]},"batteryType":{"type":"string","enum":["LITHIUM_ION","NICKEL_METAL_HYDRIDE","LEAD_ACID"]}}},"AssignVehicleRequest":{"required":["vin"],"type":"object","properties":{"vin":{"pattern":"^[A-HJ-NPR-Z0-9]{17}$","type":"string"}}},"ChangePasswordRequest":{"required":["confirmPassword","newPassword","oldPassword"],"type":"object","properties":{"oldPassword":{"type":"string"},"newPassword":{"maxLength":2147483647,"minLength":6,"type":"string"},"confirmPassword":{"type":"string"}}},"CalculateRequest":{"type":"object","properties":{"quantity":{"type":"integer","format":"int32"}}},"SwapRequest":{"type":"object","properties":{"bookingId":{"type":"integer","format":"int64"},"batteryInIds":{"type":"array","items":{"type":"string"}},"staffUserId":{"type":"string"}}},"BatteryModelCheckRequest":{"type":"object","properties":{"bookingId":{"type":"integer","description":"ID của booking cần kiểm tra","format":"int64","example":146},"batteryIds":{"type":"array","description":"Danh sách mã pin cần kiểm tra","example":["BAT134","BAT129","BAT200"],"items":{"type":"string","description":"Danh sách mã pin cần kiểm tra","example":"[\"BAT134\",\"BAT129\",\"BAT200\"]"}}},"description":"Kiem tra model pin"},"SwapCancelRequest":{"type":"object","properties":{"bookingId":{"type":"integer","format":"int64","example":146},"cancelType":{"type":"string","example":"PERMANENT"}}},"TicketRequest":{"required":["bookingId","description","disputeReason","staffId","stationId","title"],"type":"object","properties":{"bookingId":{"type":"integer","format":"int64"},"staffId":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"disputeReason":{"type":"string"},"stationId":{"type":"integer","format":"int32"}}},"InspectionRequest":{"type":"object","properties":{"batteryInId":{"type":"string"},"bookingId":{"type":"integer","format":"int64"},"stateOfHealth":{"type":"number","format":"double"},"physicalNotes":{"type":"string"},"status":{"type":"string"},"staffId":{"type":"string"},"damageLevel":{"type":"string"}}},"RebalanceRequest":{"type":"object","properties":{"fromStationId":{"type":"integer","format":"int32"},"toStationId":{"type":"integer","format":"int32"},"batteryType":{"type":"string","enum":["LITHIUM_ION","NICKEL_METAL_HYDRIDE","LEAD_ACID"]},"quantity":{"type":"integer","format":"int32"},"note":{"type":"string"}}},"RebalanceSuggestion":{"type":"object","properties":{"from":{"type":"string"},"to":{"type":"string"},"quantity":{"type":"integer","format":"int32"},"reason":{"type":"string"},"confidence":{"type":"integer","format":"int32"},"priority":{"type":"string"},"batteryType":{"type":"string"}}},"UseSwapRequest":{"required":["invoiceId","userId"],"type":"object","properties":{"userId":{"type":"string"},"invoiceId":{"type":"integer","format":"int64"}}},"SubscriptionRequest":{"required":["planId","userId"],"type":"object","properties":{"planId":{"type":"integer","format":"int32"},"userId":{"type":"string"},"paymentMethod":{"type":"string","description":"Phương thức thanh toán: 'WALLET' hoặc 'VNPAY'","example":"WALLET"}}},"CancelRequest":{"type":"object","properties":{"userId":{"type":"string"}}},"WalletTopupRequest":{"required":["amount"],"type":"object","properties":{"amount":{"type":"number","description":"Số tiền cần nạp vào ví (VNĐ)","format":"double","example":200000},"bankCode":{"type":"string","description":"Mã ngân hàng (VD: NCB, VNPAY...)","example":"VNPAY"},"orderType":{"type":"string","description":"Loại đơn hàng","example":"wallet_topup"}}},"VnPayCreatePaymentRequest":{"required":["invoiceId"],"type":"object","properties":{"invoiceId":{"type":"integer","description":"Mã hóa đơn cần thanh toán","format":"int64","example":10005},"bankCode":{"type":"string","description":"Mã ngân hàng (VD: VNPAY)","example":"VNPAY"},"orderType":{"type":"string","description":"Loại đơn hàng (VD: other, electric, etc.)","example":"other"}}},"VnPayCreatePaymentResponse":{"type":"object","properties":{"paymentUrl":{"type":"string"}}},"BookingRequest":{"required":["bookingDate","stationId","timeSlot"],"type":"object","properties":{"userId":{"type":"string"},"stationId":{"type":"integer","format":"int32"},"vehicleId":{"type":"integer","format":"int32"},"bookingDate":{"type":"string","format":"date"},"timeSlot":{"type":"string"},"batteryType":{"type":"string"},"batteryCount":{"type":"integer","format":"int32"},"vehicleIds":{"maxItems":3,"minItems":0,"type":"array","items":{"type":"integer","format":"int32"}},"paymentMethod":{"type":"string"},"notes":{"type":"string"}}},"PaymentCompletedRequest":{"type":"object","properties":{"vehicleId":{"type":"integer","format":"int32"},"stationId":{"type":"integer","format":"int32"},"bookingDate":{"type":"string"},"timeSlot":{"type":"string"},"quantity":{"type":"integer","format":"int32"},"paidAmount":{"type":"number","format":"double"},"paymentId":{"type":"string"},"paymentMethod":{"type":"string"}}},"FlexibleBatchBookingRequest":{"required":["bookings"],"type":"object","properties":{"userId":{"type":"string"},"paymentMethod":{"type":"string"},"bookings":{"maxItems":3,"minItems":1,"type":"array","items":{"$ref":"#/components/schemas/BookingRequest"}}}},"ResetPasswordRequest":{"type":"object","properties":{"token":{"type":"string","description":"Token đặt lại mật khẩu được gửi qua email"},"newPassword":{"type":"string","description":"Mật khẩu mới","example":"123456"},"confirmPassword":{"type":"string","description":"Xác nhận lại mật khẩu mới","example":"123456"}}},"RegisterRequest":{"required":["address","confirmPassword","email","fullName","password","phone"],"type":"object","properties":{"fullName":{"pattern":"^[\\p{L} ]+$","type":"string","example":"Nguyen Van A"},"email":{"type":"string"},"phone":{"pattern":"^[0-9]{10,11}$","type":"string"},"address":{"type":"string"},"password":{"maxLength":2147483647,"minLength":6,"type":"string"},"confirmPassword":{"type":"string"}}},"LoginRequest":{"required":["email","password"],"type":"object","properties":{"email":{"type":"string"},"password":{"maxLength":2147483647,"minLength":6,"type":"string"}}},"GoogleLoginRequest":{"type":"object","properties":{"token":{"type":"string"}}},"ForgotPasswordRequest":{"type":"object","properties":{"email":{"type":"string","description":"Email người dùng cần đặt lại mật khẩu","example":"driver001@gmail.com"}}},"CreateStaffRequest":{"required":["email","name","password"],"type":"object","properties":{"name":{"pattern":"^[\\p{L} ]+$","type":"string","example":"Ten"},"email":{"type":"string","example":"staff001@gmail.com"},"password":{"maxLength":2147483647,"minLength":6,"type":"string","example":"123456"},"stationId":{"type":"integer","description":"ID của trạm mà staff được gán (có thể null nếu chưa gán)","format":"int32","example":1}}},"BatteryStatusUpdateRequest":{"type":"object","properties":{"batteryId":{"type":"string","description":"ID của pin cần cập nhật","example":"BAT001"},"newStatus":{"type":"string","description":"Trạng thái mới của pin","example":"CHARGING","enum":["AVAILABLE","IN_USE","CHARGING","MAINTENANCE","WAITING"]}}},"VehicleInfoResponse":{"type":"object","properties":{"vehicleId":{"type":"integer","format":"int32"},"vin":{"type":"string"},"ownerName":{"type":"string"},"vehicleType":{"type":"string"},"batteryType":{"type":"string"},"batteryCount":{"type":"integer","format":"int32"},"purchaseDate":{"type":"string","format":"date"},"manufactureYear":{"type":"integer","format":"int32"},"color":{"type":"string"},"active":{"type":"boolean"},"licensePlate":{"type":"string"},"userId":{"type":"string"},"batteryIds":{"type":"string"}}},"VehicleSimpleResponse":{"type":"object","properties":{"vehicleId":{"type":"integer","format":"int32"},"vehicleType":{"type":"string"},"batteryType":{"type":"string"},"batteryCount":{"type":"integer","format":"int32"},"ownerName":{"type":"string"},"color":{"type":"string"},"licensePlate":{"type":"string"},"active":{"type":"boolean"},"vin":{"type":"string"}}},"VehicleMyResponse":{"type":"object","properties":{"vehicleId":{"type":"integer","format":"int32"},"vehicleType":{"type":"string"},"batteryType":{"type":"string"},"manufactureDate":{"type":"string"},"purchaseDate":{"type":"string"},"licensePlate":{"type":"string"},"color":{"type":"string"},"batteryCount":{"type":"integer","format":"int32"},"ownerName":{"type":"string"},"active":{"type":"boolean"},"vin":{"type":"string"},"batteryIds":{"type":"string"}}},"BatteryTypeRow":{"type":"object","properties":{"batteryType":{"type":"string"},"available":{"type":"integer","format":"int32"},"charging":{"type":"integer","format":"int32"},"total":{"type":"integer","format":"int32"}}},"StationResponseDTO":{"type":"object","properties":{"stationId":{"type":"integer","format":"int32"},"stationName":{"type":"string"},"address":{"type":"string"},"latitude":{"type":"number"},"longitude":{"type":"number"},"totalBatteries":{"type":"integer","format":"int32"},"availableCount":{"type":"integer","format":"int32"},"chargingCount":{"type":"integer","format":"int32"},"batteries":{"type":"array","items":{"$ref":"#/components/schemas/BatteryTypeRow"}},"active":{"type":"boolean"}}},"DockBatteryGroupDTO":{"type":"object","properties":{"dockName":{"type":"string"},"slots":{"type":"array","items":{"$ref":"#/components/schemas/SlotBatteryDTO"}}}},"SlotBatteryDTO":{"type":"object","properties":{"slotId":{"type":"integer","format":"int32"},"slotNumber":{"type":"integer","format":"int32"},"slotCode":{"type":"string"},"batteryId":{"type":"string"},"batteryType":{"type":"string"},"batteryStatus":{"type":"string"},"currentCapacity":{"type":"number","format":"double"},"stateOfHealth":{"type":"number","format":"double"}}},"PaymentResponse":{"type":"object","properties":{"txnRef":{"type":"string"},"paymentStatus":{"type":"string"},"invoiceStatus":{"type":"string"},"invoiceId":{"type":"integer","format":"int64"},"amount":{"type":"number","format":"double"},"gateway":{"type":"string"},"vnpTransactionNo":{"type":"string"},"vnpResponseCode":{"type":"string"},"vnpBankCode":{"type":"string"},"vnpPayDate":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"message":{"type":"string"}}},"DashboardResponse":{"type":"object","properties":{"totalVehicle":{"type":"integer","format":"int32"},"totalStation":{"type":"integer","format":"int32"},"totalPendingSwappingBooking":{"type":"integer","format":"int32"},"totalSubscription":{"type":"integer","format":"int32"},"activeUsers":{"type":"integer","format":"int64"},"swapsToday":{"type":"integer","format":"int32"},"revenueToday":{"type":"number","format":"double"}}},"StationStaffGroupDTO":{"type":"object","properties":{"stationId":{"type":"integer","format":"int32"},"stationName":{"type":"string"},"address":{"type":"string"},"staffList":{"type":"array","items":{"$ref":"#/components/schemas/StaffListItemDTO"}},"active":{"type":"boolean"}}}}}}